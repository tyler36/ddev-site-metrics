name: site-metrics

project_files:
  - commands/host/prometheus
  - grafana/dashboards
  - grafana/datasources/ddev-mysql.yml
  - grafana/datasources/ddev-postgres.yml
  - grafana/datasources/ddev-prometheus.yml
  - prometheus/prometheus.yml
  - commands/host/grafana
  - docker-compose.prometheus.yaml
  - docker-compose.grafana.yaml
  # The following files belong to the nginx-prometheus-exporter feature.
  - docker-compose.nginx-prometheus-exporter.yaml
  - nginx_full/stub_status.conf
  - grafana/dashboards/nginx.json
  # The following files belong to the mysqld-exporter feature.
  - docker-compose.mysqld-exporter.yaml
  - mysqld_exporter

# Available with DDEV v1.23.4+, and works only for DDEV v1.23.4+ binaries
ddev_version_constraint: '>= v1.24.3'

post_install_actions:
  - ddev dotenv set .ddev/.env --prometheus-https-port=9090
  - ddev dotenv set .ddev/.env --grafana-https-port=3000
